/* ===== 1. 기본 설정 및 변수 ===== */
:root,
html[data-theme="light"] {
  --color-background: #f8f9fa;
  --color-surface: #ffffff;
  --color-primary: #4285f4;
  --color-primary-hover: #3c78d8;
  --color-primary-bg: #e8f0fe;
  --color-text-primary: #202124;
  --color-text-secondary: #5f6368;
  --color-border: #e8eaed;
  --color-success: #34a853;
  --color-warning: #fbbc05;
  --color-danger: #ea4335;
  --color-success-bg: #e6f4ea;
  --color-warning-bg: #fff0e0;
  --color-danger-bg: #fce8e6;
  --font-family: "Noto Sans KR", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  --shadow-sm: 0 1px 2px rgba(60, 64, 67, 0.08), 0 1px 4px rgba(60, 64, 67, 0.08);
  --shadow-md: 0 4px 6px -1px rgba(60, 64, 67, 0.1), 0 2px 4px -1px rgba(60, 64, 67, 0.08);
  --border-radius: 12px;
  --transition-fast: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
}

html[data-theme="dark"] {
  --color-background: #17181a;
  --color-surface: #202124;
  --color-primary: #8ab4f8;
  --color-primary-hover: #a3c5f9;
  --color-primary-bg: #283141;
  --color-text-primary: #e8eaed;
  --color-text-secondary: #9aa0a6;
  --color-border: #3c4043;
  --color-success: #81c995;
  --color-warning: #fdd663;
  --color-danger: #f28b82;
  --color-success-bg: #2d3b32;
  --color-warning-bg: #4d4029;
  --color-danger-bg: #4d2c2a;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
body{background-color:var(--color-background);color:var(--color-text-primary);font-family:var(--font-family);font-size:14px;line-height:1.6;transition:background-color .3s,color .3s}

/* ===== 2. 레이아웃 ===== */
.app-container{max-width:1400px;margin:0 auto;padding:24px}
.layout{display:grid;grid-template-columns:1.5fr 1fr;grid-template-areas:"company company" "riskg riskp" "chart riskf" "sector news" "report report" "bench bench";gap:20px;margin-top:20px}
.company{grid-area:company} .news{grid-area:news} .riskg{grid-area:riskg} .chart{grid-area:chart} .riskp{grid-area:riskp} .riskf{grid-area:riskf} .bench{grid-area:bench} .sector{grid-area:sector} .report{grid-area:report}

/* ===== 3. 공통 컴포넌트 ===== */
.card{background-color:var(--color-surface);border:1px solid var(--color-border);border-radius:var(--border-radius);box-shadow:var(--shadow-sm);padding:20px;transition:var(--transition-fast);display:flex;flex-direction:column}
.card:hover{transform:translateY(-2px);box-shadow:var(--shadow-md)}
.card__header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid var(--color-border);flex-shrink:0}
.card__title{font-size:16px;font-weight:700}
.card__content{flex-grow:1; display: flex; flex-direction: column; min-height: 0;}
.card__content.content--center{align-items:center;justify-content:center}
.card__note{font-size:12px;color:var(--color-text-secondary);text-align:center;margin-top:auto;padding-top:12px}
.placeholder-text{margin:auto;color:var(--color-text-secondary)}

.button{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:8px 16px;border-radius:8px;border:none;font-weight:500;cursor:pointer;transition:var(--transition-fast);white-space:nowrap}
.button:active{transform:scale(.98)}
.button:disabled{cursor:not-allowed;opacity:.6}
.button--primary{background-color:var(--color-primary);color:#fff}
html[data-theme=dark] .button--primary{color:#202124}
.button--primary:hover:not(:disabled){background-color:var(--color-primary-hover)}
.button--secondary{background-color:transparent;color:var(--color-text-primary);border:1px solid var(--color-border)}
.button--secondary:hover:not(:disabled){background-color:var(--color-background)}
.button--icon{padding:8px}

.chip {
  display: inline-block;
  padding: 3px 12px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 700;
  text-align: center;
  white-space: nowrap; /* ✅ [추가] 글자가 길어도 한 줄로 표시됩니다. */
}
.chip--safe{background-color:var(--color-success-bg);color:var(--color-success)}
.chip--warn{background-color:var(--color-warning-bg);color:var(--color-warning)}
.chip--danger{background-color:var(--color-danger-bg);color:var(--color-danger)}
.chip--default{background-color:var(--color-background);color:var(--color-text-secondary);border:1px solid var(--color-border)}

/* ===== 4. 개별 컴포넌트 스타일 (Chart.js 캔버스 포함) ===== */

/* ===== 헤더 스타일 ===== */
.header {
  display: flex;
  align-items: center;
  gap: 16px;
  padding: 12px 24px;
  background-color: var(--color-surface);
  border-radius: var(--border-radius);
  box-shadow: var(--shadow-sm);
  position: sticky;
  top: 16px;
  z-index: 10;
}

.header__brand {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-right: auto; /* 이 속성이 버튼들을 오른쪽으로 밀어냅니다 */
}

.header__brand h1 {
  font-size: 20px;
  font-weight: 700;
  color: var(--color-text-primary);
  white-space: nowrap;
}

.header__search {
  position: relative;
  display: flex;
  align-items: center;
}

.header__search .material-symbols-outlined {
  position: absolute;
  left: 12px;
  color: var(--color-text-secondary);
  pointer-events: none; /* 아이콘 위로 마우스가 가도 입력 가능 */
}

.header__search input {
  min-width: 320px;
  padding: 10px 12px 10px 40px; /* 아이콘을 위한 왼쪽 여백 */
  border-radius: 8px;
  border: 1px solid var(--color-border);
  background-color: var(--color-background);
  color: var(--color-text-primary);
  transition: var(--transition-fast);
}

.header__search input:focus {
  outline: none;
  border-color: var(--color-primary);
  box-shadow: 0 0 0 3px var(--color-primary-bg);
}

.header__search .button {
  margin-left: 8px;
}

.header__actions {
  display: flex;
  align-items: center;
  gap: 8px;
}

/* 차트 컨테이너 */
.card.chart .card__content, .card.sector .card__content {
    position: relative;
    height: 320px; /* 차트 높이 고정 */
}
canvas {
    width: 100% !important;
    height: 100% !important;
}


/* ... (이전 CSS의 기본 설정, 레이아웃, 공통 컴포넌트 부분은 거의 동일) ... */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
body{background-color:var(--color-background);color:var(--color-text-primary);font-family:var(--font-family);font-size:14px;line-height:1.6;transition:background-color 0.3s, color 0.3s}
.container{max-width:1400px;margin:0 auto;padding:24px}
.dashboard-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-top:20px}
.card{background-color:var(--color-surface);border:1px solid var(--color-border);border-radius:var(--border-radius);box-shadow:var(--shadow-sm);padding:20px;transition:var(--transition-fast);position:relative;overflow:hidden}
.card:hover{transform:translateY(-2px);box-shadow:var(--shadow-md)}
.card--grid-col-2{grid-column:span 2}
.card--grid-col-3{grid-column:span 3}
.card__header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid var(--color-border)}
.card__title{font-size:16px;font-weight:700;color:var(--color-text-primary)}
.card__content.content--center{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%}
.card__note{font-size:12px;color:var(--color-text-secondary);text-align:center;margin-top:16px}
.button{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:8px 16px;border-radius:8px;border:none;font-weight:500;cursor:pointer;transition:var(--transition-fast)}
.button:active{transform:scale(0.98)}
.button--primary{background-color:var(--color-primary);color:#fff}
html[data-theme="dark"] .button--primary{color:#202124}
.button--primary:hover{background-color:var(--color-primary-hover)}
.button--secondary{background-color:transparent;color:var(--color-text-primary);border:1px solid var(--color-border)}
.button--secondary:hover{background-color:var(--color-border)}
.button--icon{padding:8px;background:transparent;border:1px solid transparent}
.button--icon:hover{background-color:var(--color-background);border-color:var(--color-border)}
.chip{display:inline-block;padding:2px 10px;border-radius:999px;font-size:12px;font-weight:500;text-align:center}
.chip--safe, .chip--success{background-color:var(--color-success-bg);color:var(--color-success)}
.chip--warn, .chip--warning{background-color:var(--color-warning-bg);color:var(--color-warning)}
.chip--danger{background-color:var(--color-danger-bg);color:var(--color-danger)}

/* ===== 4. 개별 섹션 스타일 (개선) ===== */


.company-info{display:flex;align-items:center;gap:16px}
.company-info__logo{width:50px;height:50px;flex-shrink:0;border-radius:50%;background-color:var(--color-primary);color:#fff;display:grid;place-items:center;font-size:16px;font-weight:700}
.company-info__name{font-size:22px;margin-bottom:4px;font-weight:700}
.company-info__meta{display:flex;align-items:center;gap:8px;color:var(--color-text-secondary)}
.company-info__meta .divider{width:1px;height:12px;background-color:var(--color-border)}

/* 부실 확률 비교 */
.risk-comparison {display:flex;justify-content:space-between;gap:16px;margin-bottom:12px}
.risk-comparison__item{text-align:center}
.risk-comparison__label{font-size:13px;color:var(--color-text-secondary)}
.risk-comparison__value{font-size:24px;font-weight:700;display:block;color:var(--color-text-primary)}
.risk-comparison__item--muted .risk-comparison__value{color:var(--color-text-secondary)}
.comparison-bar{position:relative;height:12px;padding:4px 0}
.comparison-bar__track{position:absolute;width:100%;height:4px;background-color:var(--color-background);border-radius:2px}
.comparison-bar__pin{position:absolute;top:50%;width:12px;height:12px;border-radius:50%;background-color:var(--color-primary);transform:translate(-50%,-50%);border:2px solid var(--color-surface);box-shadow:var(--shadow-sm)}
.comparison-bar__pin--industry{background-color:var(--color-text-secondary)}

/* ===== Beneish M-Score (순수 CSS 방식) ===== */
.benish-card {
  display: flex;
  flex-direction: column;
  gap: 12px;
}
.benish-card__head {
  display: flex;
  align-items: center;
  justify-content: space-between;
}
.benish-card__title {
  font-size: 16px;
  font-weight: 700;
  color: var(--color-text-primary);
}

/* 도넛 모양 스타일 */
.benish-donut {
  --size: 180px;
  --track-color: var(--color-success); /* 정상일 때 색상 */
  --fill-color: var(--color-danger);   /* 의심일 때 색상 */
  
  width: var(--size);
  aspect-ratio: 1;
  margin: 16px auto;
  border-radius: 50%;
  position: relative;
  display: grid;
  place-items: center;

  /* score_fill 값이 100일 때만 --fill-color, 나머지는 --track-color */
  background: conic-gradient(var(--fill-color) var(--bn-pct), var(--track-color) 0);
}
/* 가운데 구멍과 텍스트 */
.benish-donut::after {
  content: "";
  position: absolute;
  inset: 15%; /* 도넛 두께 조절 (숫자가 클수록 얇아짐) */
  background: var(--color-surface);
  border-radius: 50%;
}
.benish-donut__center {
  z-index: 1;
  text-align: center;
}
.benish-value {
  font-size: 24px;
  font-weight: 700;
  line-height: 1.1;
  color: var(--color-text-primary);
}
.benish-label, .benish-year {
  font-size: 13px;
  color: var(--color-text-secondary);
}

/* 하단 설명과 상태 칩 */
.benish-note {
  text-align: center;
  padding: 8px;
  background-color: var(--color-background);
  border-radius: 8px;
  font-size: 12px;
  margin-top: auto;
}
.benish-chip {
  padding: 4px 12px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 700;
}
.benish-chip.safe { background-color: var(--color-success-bg); color: var(--color-success); }
.benish-chip.danger { background-color: var(--color-danger-bg); color: var(--color-danger); }

/* 재무 지표 리스트 */
.financials-list{display:flex;flex-direction:column;gap:12px}
.metric-item{display:flex;justify-content:space-between;align-items:center}
.metric-item__label{color:var(--color-text-secondary)}
.metric-item__value{font-weight:500;display:flex;align-items:center;gap:8px}

/* ===== 위험개선요인 카드 스타일 ===== */
.risk-factor-list {
  display: flex;
  flex-direction: column;
  gap: 14px; /* 각 항목 사이의 세로 간격 */
}
.risk-factor-row {
  display: grid;
  /* 영역: [지표이름] 100px | [막대그래프] 남은공간 | [값] 60px */
  grid-template-columns: 100px 1fr 60px;
  align-items: center;
  gap: 12px;
}
.risk-factor-label {
  font-size: 13px;
  color: var(--color-text-secondary);
  white-space: nowrap;
}
.risk-factor-bar-track {
  height: 8px;
  background-color: var(--color-background);
  border-radius: 4px;
  overflow: hidden;
}
.risk-factor-bar {
  height: 100%;
  border-radius: 4px;
  background-color: var(--color-primary);
  /* 막대가 채워지는 애니메이션 효과 */
  transform-origin: left;
  animation: scale-bar 0.7s cubic-bezier(0.25, 1, 0.5, 1);
}

/* ✅ 음수 값을 위한 스타일 (경고색 사용) */
.risk-factor-bar.is-negative {
  background-color: var(--color-primary);
}

.risk-factor-value {
  font-size: 13px;
  font-weight: 500;
  color: var(--color-text-primary);
  text-align: right;
  font-variant-numeric: tabular-nums; /* 숫자가 같은 폭을 갖도록 */
}

@keyframes scale-bar {
  from { transform: scaleX(0); }
  to { transform: scaleX(1); }
}

/* 섹터 리스크 바 차트 */
.sector-chart{display:flex;flex-direction:column;gap:10px}
.sector-bar{display:grid;grid-template-columns:140px 1fr 50px;align-items:center;gap:12px;font-size:13px}
.sector-bar__label{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;color:var(--color-text-secondary)}
.sector-bar__track{height:10px;background-color:var(--color-background);border-radius:5px;overflow:hidden}
.sector-bar__fill{height:100%;background-color:var(--color-primary);border-radius:5px;transform:scaleX(0);transform-origin:left;animation:fill-bar 0.8s cubic-bezier(0.25, 1, 0.5, 1) forwards}
.sector-bar--highlight .sector-bar__fill{background-color:var(--color-success)}
.sector-bar--highlight .sector-bar__label{color:var(--color-text-primary);font-weight:500}
.sector-bar__value{text-align:right;font-weight:500;color:var(--color-text-secondary)}
@keyframes fill-bar{to{transform:scaleX(1)}}

/* ===== AI 리포트 카드 스타일 ===== */
.ai-report-placeholder {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  height: 100%;
  color: var(--color-text-secondary);
}

.ai-report-placeholder .material-symbols-outlined {
  font-size: 48px;
  margin-bottom: 12px;
}

.ai-report-placeholder p {
  line-height: 1.6;
}

/* 생성된 리포트 컨텐츠 스타일 (Markdown 형식) */
.markdown-body {
  font-size: 14px;
  line-height: 1.7;
  color: var(--color-text-primary);
}
.markdown-body h4 {
  font-size: 16px;
  font-weight: 700;
  margin-top: 20px;
  margin-bottom: 10px;
  padding-bottom: 6px;
  border-bottom: 1px solid var(--color-border);
}
.markdown-body p {
  margin-bottom: 12px;
}
.markdown-body ul {
  margin-bottom: 12px;
  padding-left: 20px;
}
.markdown-body strong {
  font-weight: 700;
  color: var(--color-primary);
}
html[data-theme="dark"] .markdown-body strong {
  font-weight: 500;
}

/* ===== AI 리포트 최종 스타일 (기존 AI 관련 CSS를 이걸로 교체) ===== */
.ai-report-placeholder {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  text-align: center;
  height: 100%;
  color: var(--color-text-secondary);
}
.ai-report-placeholder .material-symbols-outlined {
  font-size: 48px;
  margin-bottom: 12px;
}
.ai-report-placeholder p {
  line-height: 1.6;
}

/* 생성된 리포트 내용물을 감싸는 전체 박스 */
.ai-report-body {
  background-color: var(--color-background);
  border-radius: 8px;
  padding: 20px;
  font-size: 14px;
  line-height: 1.8; /* 줄 간격을 조금 더 넓게 */
  color: var(--color-text-primary);
  height: 100%;
  overflow-y: auto;
}

/* 각 소제목 (핵심요약, 부실위험평가 등) */
.ai-report-body h4 {
  font-size: 16px;
  font-weight: 700;
  margin-top: 24px; /* 제목 위 여백 추가 */
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--color-border);
}
.ai-report-body h4:first-child {
  margin-top: 0; /* 첫 번째 제목의 위 여백은 제거 */
}

/* 일반 문단 */
.ai-report-body p {
  margin-bottom: 16px; /* 문단 아래 여백 추가 */
}

/* 점으로 된 목록 */
.ai-report-body ul {
  margin-bottom: 16px;
  padding-left: 20px;
}
.ai-report-body ul li {
  margin-bottom: 6px;
}

/* ✅ [추가] 번호가 붙는 목록(1,2,3)의 숫자와 들여쓰기를 제거합니다. */
.ai-report-body ol {
  list-style-type: none;
  padding-left: 0;
  margin-bottom: 16px;
}
.ai-report-body ol li {
  margin-bottom: 6px;
}

/* 강조 텍스트 */
.ai-report-body strong {
  font-weight: 700;
  color: var(--color-primary);
}
html[data-theme="dark"] .ai-report-body strong {
  font-weight: 500;
}

/* ===== 게이지 차트 최종 스타일 (기존 gauge 관련 CSS는 지우고 이걸로 교체) ===== */
.gauge-container {
  position: relative;
  width: 100%;
  max-width: 280px; /* ✅ 게이지 크기를 키웁니다 (250px -> 280px) */
  margin: 0 auto;
}

/* 점수와 상태 텍스트를 담는 컨테이너 */
.gauge-status {
  position: absolute;
  /* 반원 중앙 아래쪽에 위치하도록 조정 */
  top: 65%;
  left: 50%;
  transform: translate(-50%, -50%);
  text-align: center;
}

.gauge-score-value {
  font-size: 36px;
  font-weight: 700;
  color: var(--color-text-primary);
  line-height: 1.1;
}

.gauge-status-text {
  font-size: 16px;
  font-weight: 700;
}
/* ===== 리스크 지표 스타일 추가 ===== */
.risk-metrics-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 20px;
  height: 100%;
}
.risk-metric-item {
  display: flex;
  flex-direction: column;
  justify-content: center;
  text-align: center;
  padding: 16px;
  background-color: var(--color-background);
  border-radius: 8px;
}
.metric-label {
  font-size: 13px;
  color: var(--color-text-secondary);
  margin-bottom: 8px;
}
.metric-value {
  font-size: 24px;
  font-weight: 700;
  color: var(--color-text-primary);
}
.metric-value--muted {
  color: var(--color-text-secondary);
}
.metric-hint {
  font-size: 11px;
  color: var(--color-text-secondary);
  margin-top: 8px;
  line-height: 1.4;
}

/* ===== 필터 UI 스타일 ===== */
.filter-ui {
  display: flex;
  gap: 12px;
  align-items: center;
  flex-wrap: wrap;
  padding: 0 0 16px;
  border-bottom: 1px solid var(--color-border);
  margin-bottom: 16px;
}
.filter-dropdown {
  position: relative;
}
.filter-dropdown > summary {
  list-style: none;
  cursor: pointer;
  border: 1px solid var(--color-border);
  border-radius: 8px;
  padding: 6px 12px;
  background-color: var(--color-surface);
}
.filter-dropdown-panel {
  position: absolute;
  top: 100%;
  left: 0;
  z-index: 10;
  width: 300px;
  background-color: var(--color-surface);
  border: 1px solid var(--color-border);
  border-top: none;
  border-radius: 0 0 8px 8px;
  box-shadow: var(--shadow-md);
  padding: 8px;
}
.filter-list {
  max-height: 200px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 4px;
}
.filter-item {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px;
  border-radius: 4px;
  cursor: pointer;
  font-size: 13px;
}
.filter-item:hover {
  background-color: var(--color-background);
}
.filter-actions {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  margin-top: 8px;
  padding-top: 8px;
  border-top: 1px solid var(--color-border);
}
.filter-actions button {
  font-size: 12px;
  padding: 4px 8px;
}
.chart-container {
  position: relative;
  flex-grow: 1; /* 남은 공간을 모두 차지 */
  min-height: 250px;
}

/* ===== 벤치마크 최종 스타일 (이 코드만 맨 아래에 추가) ===== */
.benchmark-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr); /* 항상 2칸으로 고정 */
  gap: 24px;
}
.benchmark-group {
  display: flex;
  flex-direction: column;
  gap: 16px;
  background-color: var(--color-background);
  padding: 16px;
  border-radius: var(--border-radius);
}
.benchmark-table {
  display: flex;
  flex-direction: column;
  gap: 16px;
}
.benchmark-row {
  display: grid;
  grid-template-columns: 130px 1fr auto;
  align-items: center;
  gap: 16px;
}
.benchmark-metric {
  font-size: 13px;
  color: var(--color-text-secondary);
  line-height: 1.4;
}
.benchmark-chart-container {
  position: relative;
  height: 36px;
}
.benchmark-result {
  text-align: right;
}
/* ... (반응형 디자인은 이전과 동일하게 유지) ... */
@media(max-width:1200px){.dashboard-grid{grid-template-columns:repeat(2,1fr)}.card--grid-col-3{grid-column:span 2}}
@media(max-width:768px)
{
  .container{padding:16px}
  .dashboard-grid{grid-template-columns:1fr}
  .card--grid-col-2,.card--grid-col-3{grid-column:span 1}
  .header{flex-direction:column;align-items:stretch;gap:12px;position:static}
  .header__brand{margin-right:0}.header__search input{min-width:0;width:100%}}